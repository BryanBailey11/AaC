---
model:  Point of Sale System
   decomp:
      ProductScanner: ./ProductScanner/ProductScanner.yaml
      ProductCatalog: ./ProductCatalog/ProductCatalog.yaml
      ShoppingCart: ./ShoppingCart/ShoppingCart.yaml
      Scale: ./Scale/Scale.yaml
      CashHandler: ./CashHandler/CashHandler.yaml
      CreditCardPad: ./CreditCardPad/CreditCardPad.yaml
      UserInterface: ./UserInterface/UserInterface.yaml
   refs:
      - name: OSHA 
         path: ./regulations/OSHA.csv
         id:s 
           - REQ-123
           - REQ-234
      - name: CONOPS 
         path: ./POS_CONOPS.md
         sections:
           - 1.2.3.4
           - 1.2.3.5


---
data: ScanResult
   fields: 
      - name: productCode
        type: int

---
data: LogEntry
   fields:
      - name: time
         type: timestamp
      - name: level
         type: string
      - name: message
         type: string

---
model: ProductScanner
   uses:
      - name: scan
         model: ../data/ScanResult.yaml
      - name: log 
         model: ../data/LogEntry.yaml
   - behaviors:
      - name: ScanProduct
        refs:
          - name: DOORS
            ids:
              - REQ-123
              - REQ-456
          - name: SCAN_HW_IF
            sections:
              - 4.2.2.1
        trigger: 
           type: poll   
           args: 
              - name: period
                 value: 100  // optionally set the polling interval in ms
           input: []
           output:
               - name: scan
                 type: pub
               - name: log
                 type: log

---
data:
   name: Catalogentry
   fields:
      - name: productID
        type: int
      - name: productName
        type: string
      - name: barcode
        type: int
        list: true
      - name: price
        type: float
        unit: USD
        validation:
         - 
      - name: weight
        type: float  
        unit: kg

---
model: ProductCatalog
   - uses:
      - scan:  ../data/ScanResult.yaml
      - product: ../data/CatalogEntry.yaml
      - log: ../data/LogEntry.yaml
   - behavior:
      - name: ProcessNewScan
         - trigger: sub
            - refs:
               - DOORS: REQ-321
            - input: ../ScanResult/ScanResult.yaml
               - ScanProduct: scan
            - output:
               - pub: product
               - pub: log